---
title: "PROBLEMAS RESUELTOS TD"
author: "Mar Canales, Camilla Bocciolone, Manuel Triviño y Carmen Puerto"
date: "`r Sys.Date()`"
format:
  typst:
    toc: true
    toc-title: "Índice"
---

\newpage

## Problema 1 (Mar Canales)

Una empresa andaluza de artículos deportivos está considerando cuatro estrategias (D1, D2, D3, D4) bajo tres posibles escenarios de mercado (E1, E2, E3) para impulsar su presencia en el mercado del pádel. La matriz de valores numéricos (en millones de euros) bajo cada escenario viene dada en la tabla siguiente:

|        | **E1** | **E2** | **E3** |
|:------:|:------:|:------:|:------:|
| **D1** |   16   |   8    |   4    |
| **D2** |   12   |   9    |   3    |
| **D3** |   14   |   7    |   1    |
| **D4** |   10   |   6    |   2    |

Resolvamos el problema:

```{r}
source("https://raw.githubusercontent.com/calote/TDecisionCodigo/refs/heads/master/teoriadecision_funciones_incertidumbre.R")

## Tabla de beneficios: 
tabla1= crea.tablaX(c(16,8,4,
                      12,9,3,
                      14,7,1,
                      10,6,2),4,3)

```

### Resolución en el caso de beneficios
**Apartado 1:** Resuelvo el problema suponiendo que los datos son beneficios

```{r}
# Pesimista
p1_pes = criterio.Wald(tabla1,T)
p1_pes$AlternativaOptima

# Optimista
p1_opt = criterio.Optimista(tabla1,T)
p1_opt$AlternativaOptima

# Hurwicz
p1_hur = criterio.Hurwicz(tabla1,T)
p1_hur$AlternativaOptima

# Estudio de la mejor alternativa en función del valor de alfa
dibuja.criterio.Hurwicz(tabla1, favorable=TRUE)

# Savage
p1_savage = criterio.Savage(tabla1,T)
p1_savage$AlternativaOptima

# Laplace
p1_laplace = criterio.Laplace(tabla1,T)
p1_laplace$AlternativaOptima

# Punto ideal
p1_puntoideal = criterio.PuntoIdeal(tabla1,T)
p1_puntoideal$AlternativaOptima

# Resumen de todos
p1_todos = criterio.Todos(tabla1,alfa=0.5, T)
# p1_todos

# tinytex::reinstall_tinytex(repository = "illinois")
# tinytex::tlmgr_install("tabularray")
library(tinytable)
tt(criterio.Todos(tabla1, 0.5, favorable = TRUE), rownames = TRUE)

```

### Conclusión

Hemos realizado todos los métodos de incertidumbre por separado y los visualizamos todos juntos con el criterio todos. En el caso de que la tabla sea de beneficios, llegamos a la conclusión de que la **alternativa d1** es la alternativa óptima ya que todos los métodos la eligen como la óptima. Como no tenemos un contexto del problema, no podemos decir más.

Además hemos estudiado la decisión según el método Hurwicz en función del valor de alfa, obteniendo que que para cualquier valor de alfa la decisión óptima con dicho método es la alternativa d1.

**Apartado 2:** Análogamente resolvamos el problema suponiendo ahora que los datos son costes

### Resolución el caso de costes
```{r}
# Pesimista
p2_pes = criterio.Wald(tabla1,F)
p2_pes$AlternativaOptima

# Optimista
p2_opt = criterio.Optimista(tabla1,F)
p2_opt$AlternativaOptima

# Hurwicz
p2_hur = criterio.Hurwicz(tabla1,F)
p2_hur$AlternativaOptima

# Estudio de la mejor alternativa en función del valor de alfa
dibuja.criterio.Hurwicz(tabla1, favorable=FALSE)

# Obtengo el resultado de cual es la mejor alternativa para cada cada valor de alfa
dibuja.criterio.Hurwicz_Intervalos(tabla1, favorable =FALSE)

# Savage
p2_savage = criterio.Savage(tabla1,F)
p2_savage$AlternativaOptima

# Laplace
p2_laplace = criterio.Laplace(tabla1,F)
p2_laplace$AlternativaOptima

# Punto ideal
p2_puntoideal = criterio.PuntoIdeal(tabla1,F)
p2_puntoideal$AlternativaOptima

# Resumen de todos
p2_todos = criterio.Todos(tabla1,alfa=0.5, F)
# p2_todos

# tinytex::reinstall_tinytex(repository = "illinois")
# tinytex::tlmgr_install("tabularray")
library(tinytable)
tt(criterio.Todos(tabla1, 0.5, favorable = FALSE), rownames = TRUE)

```

### Conclusión

Hemos realizado todos los métodos de incertidumbre por separado y los visualizamos todos juntos con el criterio todos. En el caso de que la tabla sea de costes, llegamos a la conclusión de que la **alternativa d4** es la alternativa óptima ya que 5 de los 6 métodos la eligen como la óptima.

Además hemos estudiado la decisión según el método Hurwicz en función del valor de alfa, obteniendo que si alfa está en el intervalo (0,0.8) la alternativa óptima es d4, sin embargo, si alfa\>0.8 seleccionaría la alternativa d3.

## Problema 2 (Mar Canales)

Una agencia de viajes sevillana está decidiendo qué tipo de paquete turístico principal ofrecer el próximo año. El éxito de cada opción dependerá del nivel de demanda turística que se presente. Alternativas:\
- D1 – Ofrecer viajes internacionales\
- D2 – Potenciar viajes nacionales\
- D3 – Promocionar escapadas de fin de semana (paquetes cortos y económicos)\
Escenarios de demanda:\
• E1 – Alta demanda turística: incremento general de viajes\
• E2 – Demanda media: comportamiento normal del mercado\
• E3 – Baja demanda: caída del turismo por crisis o factores externos como la guerra\
Los siguientes valores representan los beneficios esperados (en miles de euros) para cada decisión bajo cada escenario:

|        | **E1** | **E2** | **E3** |
|:------:|:------:|:------:|:------:|
| **D1** |  300   |  180   |   60   |
| **D2** |  220   |  190   |  130   |
| **D3** |  150   |  160   |  140   |

### Resolución
Procedemos a la resolución del problema:

```{r}
tabla2=crea.tablaX(c(300,180,60,
                     220,190,130,
                     150,160,140),3,3)
# Añado nombres a las columnas
colnames(tabla2) = c("Alta demanda", "Media", "Baja")

# Resolvemos con la función de todos
p3_todos = criterio.Todos(tabla2,alfa=0.5, T)
# p3_todos

# Estudio de la mejor alternativa en función del valor de alfa
dibuja.criterio.Hurwicz(tabla2, favorable=T)

# Obtengo el resultado de cual es la mejor alternativa para cada cada valor de alfa
dibuja.criterio.Hurwicz_Intervalos(tabla2, favorable =T)


# tinytex::reinstall_tinytex(repository = "illinois")
# tinytex::tlmgr_install("tabularray")
# library(tinytable)
tt(criterio.Todos(tabla2, 0.5, favorable = TRUE), rownames = TRUE)
```

### Conclusión

En esta ocasión utilizamos directamente el criterio de todos, este nos muestra que para 5 de los 6 métodos, d1 es la mejor opción y, para 3 de ellos hay un empate con d2, y para el método de Wald el mejor sería d3. Por tanto, **la opción idónea será d1 que es ofrecer viajes internacionales.**\
La única excepción en la que recomendaría que la decición fuera d3, sería si supiéramos que la agencia de viajes es pesimista.

Por último, hemos estudiado la decisión según el método Hurwicz en función del valor de alfa, obteniendo que si alfa está en el intervalo (0,0.143) la alternativa óptima es d3, si alfa está en (0.143, 0.467) será d2, y finalmente, si alfa\>0.467 seleccionaría la alternativa d1.

\newpage

## Problema 1 (Camilla Bocciolone)

Aplicar los criterios de decisión bajo incertidumbre a el problema cuya tabla de decisión es la siguiente:

**favorable**

|     | E1  | E2  | E3  |
|-----|-----|-----|-----|
| D1  | 90  | 45  | -10 |
| D2  | 70  | 55  | 15  |
| D3  | 40  | 35  | 22  |

**desfavorable**

|     | E1  | E2  | E3  |
|-----|-----|-----|-----|
| D1  | -90 | -45 | 10  |
| D2  | -70 | -55 | -15 |
| D3  | -40 | -35 | -22 |

resolverlo con cada uno de los métodos o funciones individuales de incertidumbre por separado (tanto en situación favorable como desfavorable)

### Resolución en la caso de beneficios
Definimos la tabla de decision

```{r}
tb01a=crea.tablaX(c(90, 45, -10,70, 55, 15,40, 35, 22),numalternativas = 3,numestados = 3)
tb01a
```

Aplico los métodos de incertidumbre

1\) CRITERIO DE WALD

```{r}
criterio.Wald(tb01a, favorable = TRUE)
```

La alternativa 3 es la mejor según el criterio de Wald.

CRITERIO OPTIMISTA

```{r}
criterio.Optimista(tb01a, favorable = TRUE)
```

La alternativa 1 es la mejor según el criterio optimista.

CRITERIO DE HURWICZ

```{r}
dibuja.criterio.Hurwicz(tb01a, favorable = TRUE)
dibuja.criterio.Hurwicz_Intervalos(tb01a, favorable = TRUE)
```

```{r}
criterio.Hurwicz(tb01a, alfa = 0, favorable = TRUE)
criterio.Hurwicz(tb01a, alfa = 0.4, favorable = TRUE)
criterio.Hurwicz(tb01a, alfa = 1, favorable = TRUE)
```

La alternativa 3 es la mejor según el criterio de Hurwicz para α \< 0.189, la 2 para 0.189\<α\<0.556 y la 1 para α\>0.556.

para α= 0.189 son óptimas tanto la 3 como la 2 y para α=0.556 la 2 y la 1.

CRITERIO DE SAVAGE

```{r}
criterio.Savage(tb01a,T)
```

La alternativa 2 es la mejor según el criterio de Savage.

CRITERIO DE LAPLACE

```{r}

criterio.Laplace(tb01a, favorable = TRUE)
```

La alternativa 2 es la mejor según el criterio de Laplace.

CRITERIO DEL PUNTO IDEAL

```{r}

criterio.PuntoIdeal(tb01a, favorable = TRUE)
```

La alternativa 2 es la mejor según el criterio del punto ideal

### Resolución en el caso de costes

Definiendo la tabla de decision

```{r}
tb01b=crea.tablaX(c(-90, -45, 10,-70, -55, -15,-40, -35, -22),numalternativas = 3,numestados = 3)
tb01b
```

Aplico los métodos de incertidumbre

1\) CRITERIO DE WALD

```{r}
criterio.Wald(tb01b, favorable = FALSE)
```

La alternativa 3 es la mejor según el criterio de Wald.

CRITERIO OPTIMISTA

```{r}
criterio.Optimista(tb01b, favorable = FALSE)
```

La alternativa 1 es la mejor según el criterio optimista.

CRITERIO DE HURWICZ

```{r}
dibuja.criterio.Hurwicz(tb01b, favorable = FALSE)
dibuja.criterio.Hurwicz_Intervalos(tb01b, favorable = FALSE)
```

```{r}
  
criterio.Hurwicz(tb01b, alfa = 0, favorable = FALSE)
criterio.Hurwicz(tb01b, alfa = 0.4, favorable = FALSE)
criterio.Hurwicz(tb01b, alfa = 1, favorable = FALSE)
```

La alternativa 3 es la mejor según el criterio de Hurwicz para α \< 0.189, la 2 para 0.189\<α\<0.556 y la 1 para α\>0.556.

para α = 0.189 son óptimas tanto la 3 como la 2 y para α=0.556 la 2 y la 1.

CRITERIO DE SAVAGE

```{r}
criterio.Savage(tb01b,FALSE)
```

La alternativa 2 es la mejor según el criterio de Savage.

CRITERIO DE LAPLACE

```{r}

criterio.Laplace(tb01b, favorable = FALSE)
```

La alternativa 2 es la mejor según el criterio de Laplace.

CRITERIO DEL PUNTO IDEAL

```{r}

criterio.PuntoIdeal(tb01b, favorable = FALSE)
```

La alternativa 2 es la mejor según el criterio del punto ideal

### Conclusiones

En situación favorable y desfavorable mismos resultados.

Tres criterios (Savage, Laplace, Punto ideal) favorecen D2; los criterios que extreman la actitud (Wald y Optimista) empujan hacia D3 (muy pesimista) o D1 (muy optimista). El criterio de Hurwicz depende de $\alpha$.

Entonces:

-   en general D2 es la opción óptima

-   Si el decisor es muy pesimista D3

-   Si es muy optimista D1

## Problema 2 (Camilla Bocciolone)

Restaurante italiano y elección del menú:
Un restaurante italiano debe decidir qué nuevo plato principal incluir en el menú de la próxima temporada. Las alternativas son:

-   **E1:** Lasagna vegetariana con verduras de temporada

-   **E2:** Risotto ai frutti di mare

-   **E3:** Ossobuco alla milanese con risotto a la milanesa

El éxito del plato depende de la preferencia de los clientes, es decir, de los **estados de la naturaleza**:

-   **S1:** Alta demanda de platos saludables y vegetarianos

-   **S2:** Preferencias equilibradas entre distintas opciones

-   **S3:** Mayor inclinación hacia la tradición italiana clásica

El restaurante estima los beneficios netos (en miles de euros) considerando los **ingresos obtenidos** por la venta del plato y los **costes de preparación** asociados.\
Así, por ejemplo:

-   Bajo **S1**, la lasaña vegetariana (**E1**) genera ingresos de 120 000 € y tiene un coste de 40 000 €, obteniendo un beneficio de **80 000 €**.\
    En cambio, el risotto ai frutti de mare (**E2**) gana 110 000 € y gasta 40 000 €, resultando en **70 000 €**,\
    mientras que el ossobuco (**E3**) solo gana 70 000 € y gasta 40 000 €, quedando con **30 000 €**.

-   Bajo **S2**, la lasaña obtiene **90 000 € de ingresos** y **40 000 € de costes**, por lo que gana **50 000 €**.\
    El risotto gana **100 000 €** y pierde **40 000 €**, quedando con **60 000 €**,\
    y el ossobuco gana **95 000 €** y pierde **40 000 €**, obteniendo **55 000 €**.

-   Finalmente, bajo **S3**, la lasaña gana **60 000 €** y pierde **40 000 €**, quedando con **20 000 €**,\
    el risotto gana **80 000 €** y pierde **40 000 €**, quedando con **40 000 €**,\
    y el ossobuco gana **130 000 €** y pierde **40 000 €**, obteniendo **90 000 €**.

Determinar cuál es la mejor decisión para el restaurante aplicando la función R que devuelve la resolución de todos los métodos en una única tabla

### Resolución

**Planteamiento**

-   Un decisor.

-   Modelo de beneficios (favorables).

-   Alternativas:

    -   **E1:** Lasagna vegetariana con verduras de temporada

    -   **E2:** Risotto ai frutti di mare

    -   **E3:** Ossobuco alla milanese con risotto a la milanesa

-   Estados de la naturaleza:

    -   **S1:** Alta demanda de platos saludables y vegetarianos

    -   **S2:** Preferencias equilibradas entre distintas opciones

    -   **S3:** Mayor inclinación hacia la tradición italiana clásica

    Valoraciones (beneficios netos en miles de €):

-   **Estado S1:**

    -   x₁,₁ = 120 − 40 = 80\
    -   x₂,₁ = 110 − 40 = 70\
    -   x₃,₁ = 70 − 40 = 30

-   **Estado S2:**

    -   x₁,₂ = 90 − 40 = 50\
    -   x₂,₂ = 100 − 40 = 60\
    -   x₃,₂ = 95 − 40 = 55

-   **Estado S3:**

    -   x₁,₃ = 60 − 40 = 20\
    -   x₂,₃ = 80 − 40 = 40\
    -   x₃,₃ = 130 − 40 = 90

-   Tabla de valoraciones:

    |     | S1  | S2  | S3  |
    |-----|-----|-----|-----|
    | E1  | 80  | 50  | 20  |
    | E2  | 70  | 60  | 40  |
    | E3  | 30  | 55  | 90  |

```{r}

tb01c=crea.tablaX(c(80, 50, 20,70, 60, 40, 30, 55, 90),numalternativas = 3,numestados = 3)

#Añado nombres a las filas y columnas
rownames(tb01c)=c("Lasagna","Ristto marisco","Ossobuco Milanés")
colnames(tb01c)=c("S1", "S2", "S3")
tb01c
```

```{r}
# Resuelvo utilizando la función 'criterio.Todos'
criterio.Todos(tb01c, favorable = TRUE, alfa = 0.5)
```

Según los resultados:

-   Criterio de Wald: mejor Risotto de marisco.

-   Criterio optimista, del punto ideal, de Laplace y de Hurwicz (α = 0.5): mejor Ossobuco a la milanesa. (Nota: α no estaba indicado en el enunciado, aquí se fija α = 0.5 para el ejemplo).

-   Criterio de Savage: Risotto de marisco y Ossobuco a la milanesa son óptimos (empate).

Observamos el comportamiento del criterio de Hurwicz en función de α:

```{r}
# Estudio la mejor alternativa para cada valor de α
dibuja.criterio.Hurwicz(tb01c, favorable = TRUE)
dibuja.criterio.Hurwicz_Intervalos(tb01c, favorable = TRUE)
```

Según el criterio de Hurwicz,

-   Risotto de marisco es la mejor alternativa para α \< 0.333,

-   Ossobuco a la milanesa es la mejor para α \> 0.333,

-   y para α = 0.333 ambas alternativas son óptimas.

### Conclusión

Utilizando el criterio de todos y suponiendo que $\alpha \geq 0.333$, se observa que en 5 de los 6 métodos la mejor opción es el Ossobuco a la milanesa, mientras que la alternativa Risotto de marisco resulta mejor según el criterio de Wald, el criterio de Savage (empate con el Ossobuco) y el criterio de Hurwicz para $\alpha \leq 0.333$ (empate en $\alpha = 0.333$ con).

Resultado final:

En general, considerando la mayoría de los criterios y un valor habitual de $\alpha$ (0.333 o superior), la mejor alternativa global es el Ossobuco a la milanesa.

Si el restaurante fuera pesimista, la alternativa Risotto de marisco sería recomandable

\newpage

## Problema 1 (Manuel Triviño)
Resolución de tabla de decisión con los métodos vistos en clase. 

Usaremos una tabla de decisión con los mismos datos que la tarea realizado en Excel para la clase de teoría, así podremos comparar si los resultados son iguales.

Al final de cada apartado pondremos una tabla resumen con todas las decisiones obtenidas.

```{r}
#| label: introducción de datos

pb1_datos <- crea.tablaX(c( 80, 60,	90,	70,	85,	75,
                95,	55,	65,	60,	70,	80,
                50,	45,	55,	60,	65,	70,
                90,	85, 95,	80,	75,	100,
                70,	60,	65,	55,	60,	65),
    numalternativas = 5, numestados = 6
)
alfaH <- 0.4 # Establecemos un nivel de alfa para el criterio de Hurwicz
```

|        | **E1** | **E2** | **E3** | **E4** | **E5** | **E6** |
|:------:|:------:|:------:|:------:|:------:|:------:|:------:|
| **D1** |   80   |   60   |   90   |   70   |   85   |   75   |
| **D2** |   95   |   55   |   65   |   60   |   70   |   80   |
| **D3** |   50   |   45   |   55   |   60   |   65   |   70   |
| **D4** |   90   |   85   |   95   |   80   |   75   |  100   |
| **D5** |   70   |   60   |   65   |   55   |   60   |   65   |

### Resolución en el caso de beneficios

```{r}
#| label: resolución en el caso favorable

waldfav <- criterio.Wald(pb1_datos, favorable = TRUE)#favorable = TRUE se refiere a beneficios
optfav <- criterio.Optimista(pb1_datos, favorable = TRUE)
hurfav <- criterio.Hurwicz(pb1_datos, alfa = alfaH, favorable =TRUE)
savagefav <- criterio.Savage(pb1_datos, favorable = TRUE)#pesos son las pérdidas
laplacefav <- criterio.Laplace(pb1_datos, favorable = TRUE) 
idealfav <- criterio.PuntoIdeal(pb1_datos, favorable = TRUE)
waldfav
optfav
hurfav
savagefav
laplacefav
idealfav
```

```{r}
#| label: representación Hurwicz caso favorable


#Rectas del método Hurwicz
dibuja.criterio.Hurwicz(pb1_datos, favorable = TRUE)
#dibuja.criterio.Hurwicz_Intervalos(pb1_datos, favorable = TRUE) No hay puntos de corte porque d4 es la mejor para cualquier valor de alpha
```

### Conclusión
En todos los criterios la mejor alternativa en el caso favorable es la **d4**. Esto resultados están acorde a lo calculado con Excel.

### Resolución en el caso de costes

Calculamos la mejor decisión con cada criterio para el caso desfavorable

```{r}
#| label: resolución en el caso desfavorable

walddes <- criterio.Wald(pb1_datos, favorable = FALSE)
optdes <- criterio.Optimista(pb1_datos, favorable = FALSE)
hurdes <- criterio.Hurwicz(pb1_datos, alfa = alfaH, favorable =FALSE)
savagedes <- criterio.Savage(pb1_datos, favorable = FALSE)
laplacedes <- criterio.Laplace(pb1_datos, favorable = FALSE) 
idealdes <- criterio.PuntoIdeal(pb1_datos, favorable = FALSE)

walddes
optdes
hurdes
savagedes
laplacedes
idealdes

#Rectas del método Hurwicz
dibuja.criterio.Hurwicz(pb1_datos, favorable = FALSE)
#dibuja.criterio.Hurwicz_Intervalos(pb1_datos, favorable = FALSE) No hay puntos de corte porque d3 siempre es la mejor para cualquier valor de alpha
```

Para todo alfa en el caso desfavorable la mejor decisión es la d3.

En el caso desfavorable elección mayoritaria será d3 en todos los criterios, sólo d5 se elige 1 vez en el criterio de Wald.

### Conclusión 
La mejor alternativa en el caso desfavorable es la **d3**. Estos resultados están acorde a lo calculado con Excel.


## Segundo problema (Manuel Triviño)
Enunciar un problema real y resolverlo mediante métodos de incertidumbre. 

Evaluación de pólizas de mantenimiento para vivienda.

Queremos contratar una póliza de mantenimiento anual para nuestra vivienda antes de un año con obras previstas. Hay cinco opciones comerciales disponibles: Plan Ahorro, Plan Básico, Plan Plus, Plan Premium y Plan Platinum. Cada plan establece una cuota anual fija y cubre distintos porcentajes del coste de reparaciones. Durante el año pueden ocurrir cuatro estados de la naturaleza mutuamente excluyentes:

-   **S1 Solo mantenimiento rutinario**: solo pequeñas reparaciones y revisiones por 300 €.

-   **S2 Avería de fontanería**: costes adicionales de fontanería 1.800 € más el mantenimiento rutinario.

-   **S3 Avería eléctrica y fontanería**: costes adicionales 3.000 € más el mantenimiento rutinario.

-   **S4 Daño estructural importante:** costes adicionales 9.000 € más el mantenimiento rutinario.

Las características de los planes son:

-   Plan Ahorro: cuota anual 120 €, cubre 0% de reparaciones (solo asesoramiento).

-   Plan Básico: cuota anual 300 €, cubre 50% de costes de reparaciones excepto daños estructurales (que cubre 0%).

-   Plan Plus: cuota anual 480 €, cubre 70% de fontanería y electricidad, 20% de daños estructurales.

-   Plan Premium: cuota anual 720 €, cubre 90% de fontanería y electricidad, 50% de daños estructurales.

-   Plan Platinum: cuota anual 1.200 €, cobertura completa 100% de todos los costes.

En principio usaremos índice de optimismo **α = 0.6.**

### Resolución

Estamos ante un problema de costes. Objetivo: minimizar el coste total del primer año ante incertidumbre sobre el estado futuro. Usaremos la función que calcula la elección para todos los métodos y veremos cuál decisión es la más acertada.

```{r}
#| label: introducción de datos pb2

# Ahorro
md11 <- 300 + 120
md12 <- 300 + 120 + 1800
md13 <- 300 + 120 + 3000
md14 <- 300 + 120 + 9000

# Básico (50% cobertura en S2 y S3, 0% en S4)
md21 <- 300 + 300
md22 <- 300 + 300 + 0.5 * 1800
md23 <- 300 + 300 + 0.5 * 3000
md24 <- 300 + 300 + 9000

# Plus (70% cobertura en S2 y S3, 20% en S4)
md31 <- 300 + 480
md32 <- 300 + 480 + 0.3 * 1800
md33 <- 300 + 480 + 0.3 * 3000
md34 <- 300 + 480 + 0.8 * 9000

# Premium (90% cobertura en S2 y S3, 50% en S4)
md41 <- 300 + 720
md42 <- 300 + 720 + 0.1 * 1800
md43 <- 300 + 720 + 0.1 * 3000
md44 <- 300 + 720 + 0.5 * 9000

# Platinum (100% cobertura en todo)
md51 <- 300 + 1200
md52 <- 1200
md53 <- 1200
md54 <- 1200



pb2_datos <- crea.tablaX(c( 
                md11, md12, md13, md14,
                md21,	md22, md23,	md24,
                md31,	md32, md33, md34,
                md41,	md42, md43,	md44,
                md51, md52, md53, md54),
    numalternativas = 5, numestados = 4,
    nb_alternativas = c("Ahorro", "Básico","Plus", "Premium", "Platinum"),
    nb_estados = c("S1", "S2", "S3", "S4")
)
alfaH2 <- 0.6 # Establecemos un nivel de alfa para el criterio de Hurwicz
```

|              | **S1** | **S2** | **S3** | **S4** |
|:------------:|:------:|:------:|:------:|:------:|
|  **Ahorro**  |  420   |  2220  |  3420  |  9420  |
|  **Básico**  |  600   |  1500  |  1800  |  9900  |
|   **Plus**   |  780   |  1320  |  1380  |  7740  |
| **Premium**  |  1020  |  1200  |  1230  |  5220  |
| **Platinum** |  1500  |  1200  |  1200  |  1200  |

```{r}

sol02 <- criterio.Todos(pb2_datos, alfa=0.6, favorable = FALSE)
sol02

dibuja.criterio.Hurwicz_Intervalos(pb2_datos, favorable=FALSE)

```

### Conclusión 
**Contratamos el plan Platinum** que ha sido el elegido en todos los métodos menos el criterio Optimista, en el que se ha optado por el plan Ahorro. Esto concuerda con el estudio que hemos realizado del criterio de Hurwicz, donde vemos que a partir de α = 0.91 elegiremos la alternativa Ahorro.

\newpage
