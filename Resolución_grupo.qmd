---
title: "PROBLEMAS RESUELTOS TD"
author: "Mar Canales"
date: "`r Sys.Date()`"
format:
  typst:
    fig-format: png
  html: default
---

## EJERCICIO 1 (Mar Canales)

Una empresa andaluza de artículos deportivos está considerando cuatro estrategias (D1, D2, D3, D4) bajo tres posibles escenarios de mercado (E1, E2, E3) para impulsar su presencia en el mercado del pádel. La matriz de valores numéricos (en millones de euros) bajo cada escenario viene dada en la tabla siguiente:

|        | **E1** | **E2** | **E3** |
|:------:|:------:|:------:|:------:|
| **D1** |   16   |   8    |   4    |
| **D2** |   12   |   9    |   3    |
| **D3** |   14   |   7    |   1    |
| **D4** |   10   |   6    |   2    |

Resolvamos el problema:

```{r}
source("teoriadecision_funciones_incertidumbre.R")

## Tabla de beneficios: 
tabla1= crea.tablaX(c(16,8,4,
                      12,9,3,
                      14,7,1,
                      10,6,2),4,3)

```

**Apartado 1:** Resuelvo el problema suponiendo que los datos son beneficios

```{r}
# Pesimista
p1_pes = criterio.Wald(tabla1,T)
p1_pes$AlternativaOptima

# Optimista
p1_opt = criterio.Optimista(tabla1,T)
p1_opt$AlternativaOptima

# Hurwicz
p1_hur = criterio.Hurwicz(tabla1,T)
p1_hur$AlternativaOptima

# Estudio de la mejor alternativa en función del valor de alfa
dibuja.criterio.Hurwicz(tabla1, favorable=TRUE)

# Savage
p1_savage = criterio.Savage(tabla1,T)
p1_savage$AlternativaOptima

# Laplace
p1_laplace = criterio.Laplace(tabla1,T)
p1_laplace$AlternativaOptima

# Punto ideal
p1_puntoideal = criterio.PuntoIdeal(tabla1,T)
p1_puntoideal$AlternativaOptima

# Resumen de todos
p1_todos = criterio.Todos(tabla1,alfa=0.5, T)
# p1_todos

# tinytex::reinstall_tinytex(repository = "illinois")
# tinytex::tlmgr_install("tabularray")
library(tinytable)
tt(criterio.Todos(tabla1, 0.5, favorable = TRUE), rownames = TRUE)

```

## Conclusión

Hemos realizado todos los métodos de incertidumbre por separado y los visualizamos todos juntos con el criterio todos. En el caso de que la tabla sea de beneficios, llegamos a la conclusión de que la **alternativa d1** es la alternativa óptima ya que todos los métodos la eligen como la óptima. Como no tenemos un contexto del problema, no podemos decir más.

Además hemos estudiado la decisión según el método Hurzwisc en función del valor de alfa, obteniendo que que para cualquier valor de alfa la decisión óptima con dicho método es la alternativa d1.

**Apartado 2:** Análogamente resolvamos el problema suponiendo ahora que los datos son costes

```{r}
# Pesimista
p2_pes = criterio.Wald(tabla1,F)
p2_pes$AlternativaOptima

# Optimista
p2_opt = criterio.Optimista(tabla1,F)
p2_opt$AlternativaOptima

# Hurwicz
p2_hur = criterio.Hurwicz(tabla1,F)
p2_hur$AlternativaOptima

# Estudio de la mejor alternativa en función del valor de alfa
dibuja.criterio.Hurwicz(tabla1, favorable=FALSE)

# Obtengo el resultado de cual es la mejor alternativa para cada cada valor de alfa
dibuja.criterio.Hurwicz_Intervalos(tabla1, favorable =FALSE)

# Savage
p2_savage = criterio.Savage(tabla1,F)
p2_savage$AlternativaOptima

# Laplace
p2_laplace = criterio.Laplace(tabla1,F)
p2_laplace$AlternativaOptima

# Punto ideal
p2_puntoideal = criterio.PuntoIdeal(tabla1,F)
p2_puntoideal$AlternativaOptima

# Resumen de todos
p2_todos = criterio.Todos(tabla1,alfa=0.5, F)
# p2_todos

# tinytex::reinstall_tinytex(repository = "illinois")
# tinytex::tlmgr_install("tabularray")
library(tinytable)
tt(criterio.Todos(tabla1, 0.5, favorable = FALSE), rownames = TRUE)

```

## Conclusión

Hemos realizado todos los métodos de incertidumbre por separado y los visualizamos todos juntos con el criterio todos. En el caso de que la tabla sea de costes, llegamos a la conclusión de que la **alternativa d4** es la alternativa óptima ya que 5 de los 6 métodos la eligen como la óptima.

Además hemos estudiado la decisión según el método Hurzwisc en función del valor de alfa, obteniendo que si alfa está en el intervalo (0,0.8) la alternativa óptima es d4, sin embargo, si alfa\>0.8 seleccionaría la alternativa d3.

\newpage

## EJERCICIO 2 (Mar Canales)

Una agencia de viajes sevillana está decidiendo qué tipo de paquete turístico principal ofrecer el próximo año. El éxito de cada opción dependerá del nivel de demanda turística que se presente. Alternativas:\
- D1 – Ofrecer viajes internacionales\
- D2 – Potenciar viajes nacionales\
- D3 – Promocionar escapadas de fin de semana (paquetes cortos y económicos)\
Escenarios de demanda:\
• E1 – Alta demanda turística: incremento general de viajes\
• E2 – Demanda media: comportamiento normal del mercado\
• E3 – Baja demanda: caída del turismo por crisis o factores externos como la guerra\
Los siguientes valores representan los beneficios esperados (en miles de euros) para cada decisión bajo cada escenario:

|        | **E1** | **E2** | **E3** |
|:------:|:------:|:------:|:------:|
| **D1** |  300   |  180   |   60   |
| **D2** |  220   |  190   |  130   |
| **D3** |  150   |  160   |  140   |

Procedemos a la resolución del problema:

```{r}
tabla2=crea.tablaX(c(300,180,60,
                     220,190,130,
                     150,160,140),3,3)
# Añado nombres a las columnas
colnames(tabla2) = c("Alta demanda", "Media", "Baja")

# Resolvemos con la función de todos
p3_todos = criterio.Todos(tabla2,alfa=0.5, T)
# p3_todos

# Estudio de la mejor alternativa en función del valor de alfa
dibuja.criterio.Hurwicz(tabla2, favorable=T)

# Obtengo el resultado de cual es la mejor alternativa para cada cada valor de alfa
dibuja.criterio.Hurwicz_Intervalos(tabla2, favorable =T)


# tinytex::reinstall_tinytex(repository = "illinois")
# tinytex::tlmgr_install("tabularray")
library(tinytable)
tt(criterio.Todos(tabla2, 0.5, favorable = TRUE), rownames = TRUE)
```

## Conclusión

En esta ocasión utilizamos directamente el criterio de todos, este nos muestra que para 5 de los 6 métodos, d1 es la mejor opción y, para 3 de ellos hay un empate con d2, y para el método de Wald el mejor sería d3. Por tanto, **la opción idónea será d1 que es ofrecer viajes internacionales.**\
La única excepción en la que recomendaría que la decición fuera d3, sería si supiéramos que la agencia de viajes es pesimista.

Por último, hemos estudiado la decisión según el método Hurzwisc en función del valor de alfa, obteniendo que si alfa está en el intervalo (0,0.143) la alternativa óptima es d3, si alfa está en (0.143, 0.467) será d2, y finalmente, si alfa\>0.467 seleccionaría la alternativa d1.

## Problema 1 (Camilla Bocciolone)

Aplicar los criterios de decisión bajo incertidumbre a el problema cuya tabla de decisión es la siguiente:

**favorable**

|     | E1  | E2  | E3  |
|-----|-----|-----|-----|
| D1  | 90  | 45  | -10 |
| D2  | 70  | 55  | 15  |
| D3  | 40  | 35  | 22  |

**desfavorable**

|     | E1  | E2  | E3  |
|-----|-----|-----|-----|
| D1  | -90 | -45 | 10  |
| D2  | -70 | -55 | -15 |
| D3  | -40 | -35 | -22 |

resuelverlo con cada uno de los métodos o funciones individuales de incertidumbre por separado (tanto en situación favorable como desfavorable)

### Resolución


```{r}
source("teoriadecision_funciones_incertidumbre.R")
```

#### Situación favorable

Definimos la tabla de decision

```{r}
tb01a=crea.tablaX(c(90, 45, -10,70, 55, 15,40, 35, 22),numalternativas = 3,numestados = 3)
tb01a
```

Aplico los métodos de incertidumbre

1\) CRITERIO DE WALD

```{r}
criterio.Wald(tb01a, favorable = TRUE)
```

La alternativa 3 es la mejor según el criterio de Wald.

CRITERIO OPTIMISTA

```{r}
criterio.Optimista(tb01a, favorable = TRUE)
```

La alternativa 1 es la mejor según el criterio optimista.

CRITERIO DE HURWICZ

```{r}
dibuja.criterio.Hurwicz(tb01a, favorable = TRUE)
dibuja.criterio.Hurwicz_Intervalos(tb01a, favorable = TRUE)
```

```{r}
criterio.Hurwicz(tb01a, alfa = 0, favorable = TRUE)
criterio.Hurwicz(tb01a, alfa = 0.4, favorable = TRUE)
criterio.Hurwicz(tb01a, alfa = 1, favorable = TRUE)
```

La alternativa 3 es la mejor según el criterio de Hurwicz para α \< 0.189, la 2 para 0.189\<α\<0.556 y la 1 para α\>0.556.

para α= 0.189 son óptimas tanto la 3 como la 2 y para α=0.556 la 2 y la 1.

CRITERIO DE SAVAGE

```{r}
criterio.Savage(tb01a,T)
```

La alternativa 2 es la mejor según el criterio de Savage.

CRITERIO DE LAPLACE

```{r}

criterio.Laplace(tb01a, favorable = TRUE)
```

La alternativa 2 es la mejor según el criterio de Laplace.

CRITERIO DEL PUNTO IDEAL

```{r}

criterio.PuntoIdeal(tb01a, favorable = TRUE)
```

La alternativa 2 es la mejor según el criterio del punto ideal

#### Situación desfavorable

Definiendo la tabla de decision

```{r}
tb01b=crea.tablaX(c(-90, -45, 10,-70, -55, -15,-40, -35, -22),numalternativas = 3,numestados = 3)
tb01b
```

Aplico los métodos de incertidumbre

1\) CRITERIO DE WALD

```{r}
criterio.Wald(tb01b, favorable = FALSE)
```

La alternativa 3 es la mejor según el criterio de Wald.

CRITERIO OPTIMISTA

```{r}
criterio.Optimista(tb01b, favorable = FALSE)
```

La alternativa 1 es la mejor según el criterio optimista.

CRITERIO DE HURWICZ

```{r}
dibuja.criterio.Hurwicz(tb01b, favorable = FALSE)
dibuja.criterio.Hurwicz_Intervalos(tb01b, favorable = FALSE)
```

```{r}
  
criterio.Hurwicz(tb01b, alfa = 0, favorable = FALSE)
criterio.Hurwicz(tb01b, alfa = 0.4, favorable = FALSE)
criterio.Hurwicz(tb01b, alfa = 1, favorable = FALSE)
```

La alternativa 3 es la mejor según el criterio de Hurwicz para α \< 0.189, la 2 para 0.189\<α\<0.556 y la 1 para α\>0.556.

para α = 0.189 son óptimas tanto la 3 como la 2 y para α=0.556 la 2 y la 1.

CRITERIO DE SAVAGE

```{r}
criterio.Savage(tb01b,FALSE)
```

La alternativa 2 es la mejor según el criterio de Savage.

CRITERIO DE LAPLACE

```{r}

criterio.Laplace(tb01b, favorable = FALSE)
```

La alternativa 2 es la mejor según el criterio de Laplace.

CRITERIO DEL PUNTO IDEAL

```{r}

criterio.PuntoIdeal(tb01b, favorable = FALSE)
```

La alternativa 2 es la mejor según el criterio del punto ideal

### Conclusión

En situación favorable y desfavorable mismos resultados.

Tres criterios (Savage, Laplace, Punto ideal) favorecen D2; los criterios que extreman la actitud (Wald y Optimista) empujan hacia D3 (muy pesimista) o D1 (muy optimista). El criterio de Hurwicz depiende de $\alpha$.

Entonces:

-   en general D2 es la opción optima

-   Si el decisor es muy pesimista D3

-   Si es muy optimista D1

## Problema 2 – Restaurante italiano y elección del menú (Camilla Bocciolone)

Un restaurante italiano debe decidir qué nuevo plato principal incluir en el menú de la próxima temporada. Las alternativas son:

-   **E1:** Lasagna vegetariana con verduras de temporada

-   **E2:** Risotto ai frutti di mare

-   **E3:** Ossobuco alla milanese con risotto a la milanesa

El exito del plato depende de la preferencia de los clientes, es decir, de los **estados de la naturaleza**:

-   **S1:** Alta demanda de platos saludables y vegetarianos

-   **S2:** Preferencias equilibradas entre distintas opciones

-   **S3:** Mayor inclinación hacia la tradición italiana clásica

El restaurante estima los beneficios esperados (en miles de €) de la siguiente form

|     | S1  | S2  | S3  |
|-----|-----|-----|-----|
| E1  | 80  | 50  | 20  |
| E2  | 70  | 60  | 40  |
| E3  | 30  | 55  | 90  |

Determinar cuál es la mejor decisión para el restaurante aplicando la función R que devuelve la resolución de todos los métodos en una única tabla

### Resolución

**Planteamento**	

-   Un decisor.

-   Modelo de beneficios (favorables).

-   Alternativas:

    -   **E1:** Lasagna vegetariana con verduras de temporada

    -   **E2:** Risotto ai frutti di mare

    -   **E3:** Ossobuco alla milanese con risotto a la milanesa

-   Estados de la naturaleza:

    -   **S1:** Alta demanda de platos saludables y vegetarianos

    -   **S2:** Preferencias equilibradas entre distintas opciones

    -   **S3:** Mayor inclinación hacia la tradición italiana clásica

-   Tabla de valoraciones:

    |     | S1  | S2  | S3  |
    |-----|-----|-----|-----|
    | E1  | 80  | 50  | 20  |
    | E2  | 70  | 60  | 40  |
    | E3  | 30  | 55  | 90  |

```{r}

tb01c=crea.tablaX(c(80, 50, 20,70, 60, 40, 30, 55, 90),numalternativas = 3,numestados = 3)

#Añado nombres a las filas y columnas
rownames(tb01c)=c("Lasagna","Ristto marisco","Ossobuco Milanés")
colnames(tb01c)=c("S1", "S2", "S3")
tb01c
```

```{r}
# Resuelvo utilizando la función 'criterio.Todos'
criterio.Todos(tb01c, favorable = TRUE, alfa = 0.5)
```

Según los resultados:

-   Criterio de Wald: mejor Risotto de marisco.

-   Criterio optimista, del punto ideal, de Laplace y de Hurwicz (α = 0.5): mejor Ossobuco a la milanesa. (Nota: α no estaba indicado en el enunciado, aquí se fija α = 0.5 para el ejemplo).

-   Criterio de Savage: Risotto de marisco y Ossobuco a la milanesa son óptimos (empate).

Observamos el comportamiento del criterio de Hurwicz en función de α:

```{r}
# Estudio la mejor alternativa para cada valor de α
dibuja.criterio.Hurwicz(tb01c, favorable = TRUE)
dibuja.criterio.Hurwicz_Intervalos(tb01c, favorable = TRUE)
```

Según el criterio de Hurwicz,

-   Risotto de marisco es la mejor alternativa para α \< 0.333,

-   Ossobuco a la milanesa es la mejor para α \> 0.333,

-   y para α = 0.333 ambas alternativas son óptimas.

### Conclusión

Utilizando el criterio de todos y suponiendo que $\alpha \geq 0.333$, se observa que en 5 de los 6 métodos la mejor opción es el Ossobuco a la milanesa, mientras que la alternativa Risotto de marisco resulta mejor según el criterio de Wald, el criterio de Savage (empate con el Ossobuco) y el criterio de Hurwicz para $\alpha \leq 0.333$ (empate en $\alpha = 0.333$ con).

Resultado final:

En general, considerando la mayoría de los criterios y un valor habitual de $\alpha$ (0.333 o superior), la mejor alternativa global es el Ossobuco a la milanesa.

Si el restaurante fuera pesimista, la alternativa Risotto de marisco sería raccomandable

